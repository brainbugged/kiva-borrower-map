<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7/leaflet.css" />
    <style>
      #map { height:300px;
        width:100%;
      }
    </style>
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script type="text/javascript"
      src="http://cdn.leafletjs.com/leaflet-0.7/leaflet.js"></script>
    <script type="text/javascript"
      src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <title>kiva-borrower-map</title>
  </head>

  <body>
    <div id="app">

    </div>
    <!-- built files will be auto injected -->
    <div.

      <p>Click the button to get your coordinates.</p>

      <button onclick="getLocation()">I am Here</button>

      <p id="demo"></p>

      <script>
      // user geolocation data
      let x = document.getElementById("demo");

      function getLocation() {
          if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(showPosition);
          } else {
              x.innerHTML = "Geolocation is not supported by this browser.";
          }
      }

      function showPosition(position) {
          x.innerHTML = "Latitude: " + position.coords.latitude +
          "<br>Longitude: " + position.coords.longitude;

          //
          let userLocation = { "lat": position.coords.latitude,
                          "lng" : position.coords.longitude
            }

          return userLocation

      }

      </script>


    </div>

      <p id="demo"></p>

    <div id="map">

      map should live here

    <script>
    let test_marker = [37.7887078, -122.1957755]

    let map = L.map('map').setView({lat:37.774, lng:-122.4194}, 10);
     mapLink =
         '<a href="http://openstreetmap.org">OpenStreetMap</a>';
     L.tileLayer(
         'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
         attribution: 'Map data &copy; ' + mapLink,
         maxZoom: 18,
         }).addTo(map);

    L.marker(test_marker, title="fists of flower").addTo(map)
    
    // user geolocation marker -- doesn't work
    let userMarker = showPosition(position)
    alert(userMarker.lat, userMarker.lng)
    L.marker([userMarker.lat, userMarker.lng], title="here i am!").addTo(map)

    let popup = L.popup()
    // .setLatLng(test_marker )
    .setContent('<p>Test: Fists of Flower </p>')
    .openOn(map);

    marker.bindPopup(popupContent).openPopup()

    </script>

    <!-- built files will be auto injected -->
  </body>
</html>
