webpackJsonp([1],[,,,,,,,,,function(t,e,o){"use strict";var n=o(2);e.a=new n.a},,function(t,e,o){var n=o(1)(o(36),o(51),null,null,null);t.exports=n.exports},function(t,e,o){"use strict";var n=o(2),a=o(56),i=o(48),s=o.n(i);n.a.use(a.a),e.a=new a.a({routes:[{path:"/",name:"Borrower Map",component:s.a}]})},function(t,e){},function(t,e,o){function n(t){o(43)}var a=o(1)(o(34),o(54),n,null,null);t.exports=a.exports},,,,,,,,,,,,,,,,,,,function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(2),a=o(14),i=o.n(a),s=o(12);o(13),n.a.config.productionTip=!1,new n.a({el:"#app",router:s.a,template:"<App/>",components:{App:i.a}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"app"}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(10),a=o.n(n),i=o(9),s=o(50),r=o.n(s),l=o(15),c=(o.n(l),o(49)),u=o.n(c),d=o(11),p=o.n(d);e.default={name:"home",data:function(){return{msg:"Kiva US Borrowers",locations:[],lat:37.8043722,lng:-122.2708026,bounds:{},noLocationMsg:"",resultsMsg:""}},components:{MapView:u.a,Locator:p.a,SearchBar:r.a},methods:{fetchLocations:function(t){this.previousQuery=t;var e=this;l.get("/locations").then(function(t){console.log(t),t.data.locations.length>0?e.updateLocations(t.data):e.expandRadius()})},executeQuery:function(t){this.noLocationMsg="",this.resultsMsg="",this.lastAttemptedQuery=t;var e=this;this.lat=t.latitude,this.lng=t.longitude,l.get("/locations",{params:{radius:t.radius,lat:t.latitude,lng:t.longitude}}).then(function(o){console.log(o),o.data.locations.length>5?(e.updateLocations(o.data),e.lastSuccessfulQuery=t,e.resultsMsg="Showing results for "+t.searchTerm+" within "+t.radius+" miles."):e.expandRadius()})},expandRadius:function(){var t=JSON.parse(a()(this.lastAttemptedQuery));t.radius=2*parseInt(this.lastAttemptedQuery.radius),t.radius<1e3?this.executeQuery(t):(this.executeQuery(this.lastSuccessfulQuery),this.noLocationMsg="No results within "+t.radius+"miles. Please try another search.")},updateLocations:function(t){this.bounds=t.bounds,this.locations=[],this.locations=t.locations}},beforeMount:function(){this.fetchLocations("test query")},mounted:function(){console.log("Home is mounted"),i.a.$emit("home-loaded","home is loaded")}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"locator",methods:{locatorDiv:function(){return document.getElementById("userLocation")},getLocation:function(){window.navigator.geolocation&&window.navigator.geolocation.getCurrentPosition(this.showPosition)},showPosition:function(t){this.$emit("getLocation",t.coords)}}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(9),a=o(46),i=o.n(a);e.default={name:"map",data:function(){return{}},props:["fetchedLocations","lat","lng","bounds"],methods:{initalizeMap:function(){this.mapView=i.a.map("map").setView({lat:this.lat,lng:this.lng},15);i.a.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a>',maxZoom:18}).addTo(this.mapView),this.currentLocationLayer=i.a.layerGroup(),this.currentLocationLayer.addTo(this.mapView)},displayLocations:function(){this.setMapViewWithBounds(),this.updateLocationLayer()},updateLocationLayer:function(){console.log("Removing "+this.currentLocationLayer.getLayers().length+" layers..."),this.currentLocationLayer.clearLayers();var t=this;this.fetchedLocations.forEach(function(e,o){var n=e,a=t.buildLocationInfo(n),s=i.a.circleMarker([n.coordinates.latitude,n.coordinates.longitude],{radius:9,stroke:!1,fillOpacity:.8,fillColor:"#63a541"}).bindPopup(a);t.currentLocationLayer.addLayer(s)}),console.log(this.currentLocationLayer.getLayers().length+" layers added to layerGroup")},buildLocationInfo:function(t){for(var e="",o=0;t.location.display_address.length>o;o++)e+=t.location.display_address[o],o<=t.location.display_address.length&&(e+="<br>");return"<h4>"+t.name+"</h4><small><b>Phone:</b><br> "+t.display_phone+"</small><br><small><b>Address:</b><br> "+e+'</small><br><small><a href="'+t.url+'" target="_blank">View on Yelp</a></small>'},setMapViewWithBounds:function(){this.bounds&&this.bounds.latmin&&this.mapView.fitBounds([[this.bounds.latmin,this.bounds.lngmin],[this.bounds.latmax,this.bounds.lngmax]])},centerMap:function(){console.log("centering"),this.mapView.setView({lat:this.lat,lng:this.lng})}},watch:{fetchedLocations:function(){this.displayLocations()},lat:function(){this.centerMap()},lng:function(){this.centerMap()}},mounted:function(){console.log("map is mounted"),this.initalizeMap(),this.displayLocations()},beforeUpdate:function(){console.log("before map update")},created:function(){n.a.$on("home-loaded",function(t){console.log(t)})}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(10),a=o.n(n),i=o(11),s=o.n(i);e.default={name:"search",data:function(){return{radius:1,searchTerm:"City, State or Zip Code",latitude:37.8043722,longitude:-122.2708026}},components:{Locator:s.a},methods:{geoCodeSearch:function(){console.log("Searching "+this.searchTerm+" within "+this.radius+" miles.");var t=new window.google.maps.Geocoder,e=this.searchTerm,o=this;t.geocode({address:e},function(t,e){"OK"===e?(o.latitude=t[0].geometry.location.lat(),o.longitude=t[0].geometry.location.lng(),console.log(t[0].geometry.location.lat(),t[0].geometry.location.lng()),o.initializeLocationQuery()):alert("Geocode was not successful for the following reason: "+e)})},initializeLocationQuery:function(){this.$emit("executeQuery",JSON.parse(a()(this.$data)))},showUserLocation:function(t){console.log(t),this.searchTerm="Your Location",this.latitude=t.latitude,this.longitude=t.longitude,this.initializeLocationQuery()},selectAll:function(t){setTimeout(function(){t.target.select()},0)}}}},,,function(t,e){},function(t,e){},function(t,e){},function(t,e){},,,,function(t,e,o){function n(t){o(41)}var a=o(1)(o(35),o(52),n,null,null);t.exports=a.exports},function(t,e,o){function n(t){o(44)}var a=o(1)(o(37),o(55),n,null,null);t.exports=a.exports},function(t,e,o){function n(t){o(42)}var a=o(1)(o(38),o(53),n,"data-v-41869ba4",null);t.exports=a.exports},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"button setting",on:{click:function(e){e.preventDefault(),t.getLocation(e)}}},[t._v("Near Me")])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("h1",[t._v(t._s(t.msg))]),t._v(" "),o("SearchBar",{on:{executeQuery:t.executeQuery}}),t._v(" "),t.noLocationMsg?o("p",[o("i",[t._v(t._s(t.noLocationMsg))])]):t._e(),t._v(" "),t.resultsMsg?o("p",[o("i",[t._v(t._s(t.resultsMsg))])]):t._e(),t._v(" "),o("div",{staticClass:"map-holder"},[o("MapView",{attrs:{fetchedLocations:t.locations,lat:t.lat,lng:t.lng,bounds:t.bounds}})],1)],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"search-bar"},[o("div",{staticClass:"row"},[o("div",{staticClass:"locator-holder small-12 large-3 column"},[o("Locator",{on:{getLocation:t.showUserLocation}})],1),t._v(" "),o("form",{staticClass:"search-form clearfix small-12 large-9 column end"},[o("div",{staticClass:"small-12 medium-4 column"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.searchTerm,expression:"searchTerm"}],staticClass:"custom-location",attrs:{type:"text"},domProps:{value:t.searchTerm},on:{focus:t.selectAll,input:function(e){e.target.composing||(t.searchTerm=e.target.value)}}})]),t._v(" "),o("div",{staticClass:"small-6 medium-4 column"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.radius,expression:"radius"}],on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.radius=e.target.multiple?o:o[0]}}},[o("option",{attrs:{value:"1"}},[t._v("Radius (Miles)")]),t._v(" "),o("option",{attrs:{value:"1"}},[t._v("1")]),t._v(" "),o("option",{attrs:{value:"2"}},[t._v("2")]),t._v(" "),o("option",{attrs:{value:"5"}},[t._v("5")]),t._v(" "),o("option",{attrs:{value:"10"}},[t._v("10")]),t._v(" "),o("option",{attrs:{value:"20"}},[t._v("20")]),t._v(" "),o("option",{attrs:{value:"50"}},[t._v("50")])])]),t._v(" "),o("div",{staticClass:"small-6 medium-4 column"},[o("button",{staticClass:"button setting",on:{click:function(e){e.preventDefault(),t.geoCodeSearch(e)}}},[t._v("Search")])])])])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pageWrap",attrs:{id:"app"}},[o("router-view")],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{attrs:{id:"map"}})},staticRenderFns:[]}}],[33]);
//# sourceMappingURL=app.61322048f64c4a122693.js.map